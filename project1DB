CREATE TABLE owners (
	id		SERIAL PRIMARY KEY,
	username	TEXT NOT NULL UNIQUE,
	age		INTEGER NOT NULL,
	state		TEXT NOT NULL
);

CREATE TABLE categories (
	id		SERIAL PRIMARY KEY,
	name		TEXT NOT NULL UNIQUE,
	description	TEXT NOT NULL
);

CREATE TABLE products (
	id		SERIAL PRIMARY KEY,
	name		TEXT NOT NULL,
	SKU		INTEGER NOT NULL UNIQUE,
	price		DOUBLE PRECISION NOT NULL
);

CREATE TABLE createCategory (
	id		SERIAL PRIMARY KEY,
	owner		INTEGER REFERENCES owners (id) NOT NULL,
	category	INTEGER REFERENCES categories (id) NOT NULL
);

CREATE TABLE hasProduct (
	id		SERIAL PRIMARY KEY,
	category	INTEGER REFERENCES categories (id) NOT NULL,
	product		INTEGER REFERENCES products (id) NOT NULL
);

CREATE TRIGGER username_trigger
BEFORE INSERT ON owners 
BEGIN
IF username = ""
THEN username = NULL

DELETE FROM owners WHERE TRUE

SELECT * FROM owners

DELETE FROM owners


SELECT * FROM categories

SELECT * FROM products

SELECT * FROM hasProduct

SELECT * FROM products WHERE id IN 
(SELECT product FROM hasProduct WHERE category 
IN (SELECT id FROM categories WHERE name = 'cat2'))

SELECT products.id, products.name, products.SKU, products.price 
FROM products, hasProduct, categories 
WHERE categories.name = 'cat2'
AND hasProduct.category = categories.id 
AND products.id = hasProduct.product

INSERT INTO products (name, SKU, price) VALUES ('prod1', 1, 1);
INSERT INTO products (name, SKU, price) VALUES ('prod2', 2, 2);
INSERT INTO products (name, SKU, price) VALUES ('prod3', 3, 3);

INSERT INTO hasProduct (category, product) VALUES (9,1);
INSERT INTO hasProduct (category, product) VALUES (10,2);
INSERT INTO hasProduct (category, product) VALUES (11,3);